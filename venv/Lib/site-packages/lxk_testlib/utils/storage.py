'''
Created on Nov 27, 2020

@author: Lenver Melgar
'''
from robot.libraries.BuiltIn import BuiltIn


def save_variable(scope, name, value):
    """
    Save the value to storage on specified scope
    """
    name = _format_name(name)
    scope = scope.lower()

    if scope == 'global':
        BuiltIn().set_global_variable(name, value)
    elif scope == 'suite':
        BuiltIn().set_suite_variable(name, value)
    elif scope == 'test':
        BuiltIn().set_test_variable(name, value)
    else:
        raise ValueError('Invalid scope "{}"'.format(scope))


def get_variable(variable):
    """
    Get variable value from storage
    """
    variable = _format_name(variable)

    return BuiltIn().get_variable_value(variable)


def _format_name(name):
    """
    Format variable name
    """
    return '${{{}}}'.format(name)
