""" UPS value setting action.
"""

from lxk_testlib.panelnav.core import exceptions
from lxk_testlib.panelnav.core.models.actions import AbstractAction

_ERROR = """Add the ff locator code:
locator.add_action(
    action={action},
    specifier={specifier}
)
"""

class GenericPresetSelect(AbstractAction):
    """ UPS value setting action for all panel sizes.
    Can only be used on a locator with a preset specifier with this action.
    """

    def get_phrase(self, *args, preset=None):
        """ Return action phrase.
        """
        if not preset:
            # TODO: add the correct specifier
            raise exceptions.LocatorActionSpecifierRequired(_ERROR.format(
                action="Action.GenericPresetSelect",
                specifier="%s"
            ))
        try:
            return self.DO_PHRASE.format(
                action=preset % (tuple(args))
            )
        except TypeError:
            raise exceptions.ActionArgumentsCountMismatch(
                self.ARG_MISMATCH.format(
                    given=args,
                    required=preset
                )
            )
