""" UPS Keyboard Actions
"""

from lxk_testlib.panelnav.core import exceptions
from lxk_testlib.panelnav.core.models.actions import AbstractAction

class GenericType(AbstractAction):
    """ UPS type action.
    """

    def __init__(self):
        self.action = "type '%s'"

    def get_phrase(self, *args, preset=None):
        """ Return action phrase.
        """
        try:
            return self.DO_PHRASE.format(
                action=self.action % (tuple(args))
            )
        except TypeError:
            raise exceptions.ActionArgumentsCountMismatch(
                self.ARG_MISMATCH.format(
                    given=args,
                    required=self.action
                )
            )

class GenericPressKey(AbstractAction):
    """ UPS press key action.
    """

    def __init__(self):
        self.action = "press key %s"

    def get_phrase(self, *args, preset=None):
        """ Return action phrase.
        """
        try:
            return self.DO_PHRASE.format(
                action=self.action % (tuple(args))
            )
        except TypeError:
            raise exceptions.ActionArgumentsCountMismatch(
                self.ARG_MISMATCH.format(
                    given=args,
                    required=self.action
                )
            )

class ClearText(AbstractAction):
    """ UPS clear text action used for touch panels only.
    For non-touch panels, use BACKSPACE or DELETE hard key.
    """

    def __init__(self):
        self.action = "clear"

    def get_phrase(self, *args, preset=None):
        """ Return action phrase.
        """
        return self.DO_PHRASE.format(action=self.action)
