"""
Peripherals/Options/Cards
-------------------------
"""

import logging
import requests

LOGGER = logging.getLogger(__name__)
LOGGER.setLevel(logging.DEBUG)

def is_hard_disk_installed(ip_address):
    """
    Checked if device has Hard Disk installed.

    :Parameters:

        1. ip_address, ``<class 'str'>``

    :Returns: ``<class 'bool'>``
    """
    LOGGER.debug(ip_address)
    response = requests.get(
        url="http://%s/cgi-bin/menu_settings_page" % ip_address,
        timeout=120
    )
    LOGGER.debug(response.text)
    return "GB Disk".lower() in response.text.lower()

def is_finisher_installed(ip_address, finisher):
    """
    Check if device's finisher (Booklet/Staple/Hole Punch) is installed.

    :Parameters:

        1. ip_address, ``<class 'str'>``
        2. finisher, ``<class 'str'>`` (i.e. Booklet, Staple or Hole Punch.)

    :Returns: ``<class 'bool'>``
    """
    LOGGER.debug(ip_address)
    LOGGER.debug(finisher)
    response = requests.get(
        url="http://%s/cgi-bin/menu_settings_page" % ip_address,
        timeout=120
    )
    LOGGER.debug(response.text.lower())
    return finisher.lower() in response.text.lower()

def is_fax_modem_card_installed(ip_address):
    """
    Check if device has fax modem installed.

    :Parameters:

        1. ip_address, ``<class 'str'>``

    :Returns: ``<class 'bool'>``
    """
    LOGGER.debug(ip_address)
    response = requests.get(
        url="http://%s/cgi-bin/faxsetup" % ip_address,
        timeout=120
    )
    LOGGER.debug(response.status_code)
    return response.status_code == 200

def is_wireless_card_installed(ip_address):
    """
    Check if device has Wireless Card installed.

    :Parameters:

        1. ip_address, ``<class 'str'>``

    :Returns:  ``<class 'bool'>``
    """
    LOGGER.debug(ip_address)
    response = requests.get(
        url="http://%s/cgi-bin/menu_settings_page" % ip_address,
        timeout=120
    )
    LOGGER.debug(response.text.lower())
    return "wireless" in response.text.lower()

def is_serial_card_installed(ip_address):
    """
    Check if device has serial card installed.

    :Parameters:

        1. ip_address, ``<class 'str'>``

    :Returns:  ``<class 'bool'>``
    """
    LOGGER.debug(ip_address)
    response = requests.get(
        url="http://%s/cgi-bin/menu_settings_page" % ip_address,
        timeout=120
    )
    LOGGER.debug(response.text.lower())
    return "serial" in response.text.lower() and "serial protocol" in response.text.lower()

def is_parallel_card_installed(ip_address):
    """
    Check if device has parallel card installed.

    :Parameters:

        1. ip_address, ``<class 'str'>``

    :Returns:  ``<class 'bool'>``
    """
    LOGGER.debug(ip_address)
    response = requests.get(
        url="http://%s/cgi-bin/menu_settings_page" % ip_address,
        timeout=120
    )
    LOGGER.debug(response.text.lower())
    return "parallel 1" in response.text.lower()
